<section class="{{ include.background }} padding-top-{{ include.padding-top }} padding-bottom-{{ include.padding-bottom }}">
    <div class="container-padding">
        <div class="selector">
            <div class="options">
                <!--  COMMENTING THIS OUT IN CASE WE NEED TO ADD NOTICE
                      AGAIN IN THE FUTURE
                <div class="note method padding-bottom-4em">
                    <div class="option-label">NOTICES</div>
                    <div class="option-notice">
                        <span>
                            <i class="fas fa-exclamation-triangle text-white"></i> Changes to builds with conda using <a href="https://docs.rapids.ai/notices/rdn0002">gcc 7.5</a>
                        </span>
                    </div>
                    <div class="option-notice">
                        <span>
                            <i class="fas fa-exclamation-triangle text-white"></i> CUDA 10.1/10.2 EOL in RAPIDS <a href="https://docs.rapids.ai/notices/rsn0006">v0.19</a>
                        </span>
                    </div>
                    <div class="option-notice">
                        <span>
                            <i class="fas fa-exclamation-triangle text-white"></i> CUDA 11.2 support in RAPIDS <a href="https://docs.rapids.ai/notices/rsn0007">v0.19</a>
                        </span>
                    </div>
                </div>
                -->
                <div class="preferred">
                    <div class="option-label"></div>
                    <div class="option-blank">
                        <span>
                            <i class="fas fa-level-up-alt fa-rotate-180 fa-down-6"></i> <i class="fas fa-check-square text-blue"></i> Preferred <i class="fas fa-level-down-alt fa-down-6"></i>
                        </span>
                    </div>
                    <div class="option-blank">
                        <span>
                            <i class="fas fa-level-up-alt fa-rotate-180 fa-down-6"></i> <i class="fas fa-flask text-orange"></i> Advanced <i class="fas fa-level-down-alt fa-down-6"></i>
                        </span>
                    </div>
                </div>
                <div class="method padding-bottom-1em">
                    <div class="option-label">Method</div>
                    <div id="conda" class="option" title="Conda install">Conda&nbsp;<i class="fas fa-box-open"></i> <span class="context"> <i class="fas fa-check-square text-blue"></i> Preferred Install Method</span></div>
                    <div id="runtime" class="option" title="Docker image with example notebooks">Docker + Examples&nbsp;<i class="fab fa-docker"></i><span class="context"> <i class="fas fa-check-square text-blue"></i> Preferred Install Method</span></div>
                    <div id="devel" class="option advanced" title="Docker image with developer tools and from source build environment ">Docker + Dev Env&nbsp;<i class="fab fa-docker"></i> <span class="context"> <i class="fas fa-flask text-orange"></i> Advanced Install Method</span></div>
                    <div id="source" class="option advanced" title="From source build">Source&nbsp;<i class="fas fa-cogs"></i><span class="context"> <i class="fas fa-flask text-orange"></i> Advanced Install Method</span></div>
                </div>
                <div class="release">
                    <div class="option-label">Release</div>
                    <div id="stable" class="option">Stable ({{ site.data.releases.stable-version }})</div>
                    <div id="nightly" class="option">Nightly ({{ site.data.releases.nightly-version }}a)</div>
                </div>
                <div class="type">
                    <div class="option-label">Type</div>
                    <div id="rapids" class="option">RAPIDS and BlazingSQL</div>
                    <div id="rapidscore" class="option">RAPIDS Core (w/o BlazingSQL)</div>
                </div>
                <div class="pkg">
                    <div class="option-label">Packages</div>
                    <div id="all" class="option">All Packages</div>
                    <div id="cudf" class="option">cuDF</div>
                    <div id="cuml" class="option">cuML</div>
                    <div id="cugraph" class="option">cuGraph</div>
                    <div id="cusignal" class="option">cuSignal</div>
                    <div id="cuspatial" class="option">cuSpatial</div>
                    <div id="cuxfilter" class="option">cuxfilter</div>
                </div>
                <div class="linux">
                    <div class="option-label">Linux</div>
                    <div id="ubuntu1604" class="option">Ubuntu 16.04&nbsp;<i class="fab fa-ubuntu"></i></div>
                    <div id="ubuntu1804" class="option">Ubuntu 18.04&nbsp;<i class="fab fa-ubuntu"></i></div>
                    <div id="ubuntu2004" class="option">Ubuntu 20.04&nbsp;<i class="fab fa-ubuntu"></i></div>
                    <div id="centos7" class="option">CentOS 7&nbsp;<i class="fab fa-centos"></i></div>
                    <div id="centos8" class="option">CentOS 8&nbsp;<i class="fab fa-centos"></i></div>
                    <div id="rhel7" class="option">RHEL 7&8&nbsp;<i class="fab fa-redhat"></i></div>
                </div>
                <div class="python">
                    <div class="option-label">Python</div>
                    <div id="py37" class="option">Python 3.7</div>
                    <div id="py38" class="option">Python 3.8</div>
                </div>
                <div class="cuda">
                    <div class="option-label">CUDA</div>
                    <div id="cuda110" class="option">CUDA 11.0</div>
                    <div id="cuda112" class="option">CUDA 11.2</div>
                </div>
                <div class="preferred">
                    <div class="option-label"></div>
                    <div class="option-blank"></div>
                    <div class="option-blank"></div>
                    <div class="option-blank"></div>
                    <div class="option-blank"></div>
                </div>
                <div class="note">
                    <div class="option-label"></div>
                    <div class="option-blank">
                        <span id="rhel7-conda-note" class="hidden option-note">
                            <i class="fas fa-exclamation-triangle text-orange"></i> <b>NOTE:</b> RHEL 7 & 8 <code>conda</code> support is provided by builds and tests on CentOS 7 or 8.<br/>The same <code>conda create</code> commands should work with <code>gcc >=7.5</code> and the correct NVIDIA and CUDA drivers.
                        </span>
                        <span id="rhel7-source-note" class="hidden option-note">
                            <i class="fas fa-exclamation-triangle text-orange"></i> <b>NOTE:</b> RHEL 7 & 8 from source build support is provided by following the build instructions for CentOS 7 or 8.<br/>The same methods should work with <code>gcc >=7.5</code> and the correct NVIDIA and CUDA drivers.
                        </span>
                        <span id="linux-conda-note" class="hidden option-note">
                            <i class="fas fa-info-circle text-blue"></i> <b>NOTE:</b> Ubuntu 16.04/18.04/20.04 & CentOS 7/8 use the same <code>conda create</code> commands.
                        </span>
                        <span id="linux-source-note" class="hidden option-note">
                            <i class="fas fa-info-circle text-blue"></i> <b>NOTE:</b> Ubuntu 16.04/18.04/20.04 & CentOS 7/8 use the same from source build instructions.
                        </span>
                        <span id="base-docker-note" class="hidden option-note">
                            <i class="fas fa-info-circle text-blue"></i> <b>NOTE:</b> For docker images without examples or notebooks replace <code>runtime</code> with <code>base</code> in the commands below.
                        </span>
                    </div>
                </div>
            </div>
            <div class="cmd">
                <div class="cmd-label">Command</div>
                <div id="command" class="cmd-box"><div class="highlight"><pre class="highlight"><code><span class="gh"># Javascript is needed for this tool to run, please make sure it is enabled</span></code></pre></div></div>
            </div>
        </div>
        <div class="selector-buttons">
            <a id="copy-command" onclick="CopyToClipboard('command-code')" class="primary-btn">COPY COMMAND <i class="fas fa-clipboard"></i></a>
            <a id="reset-selector" onclick="resetSelector()" class="primary-btn">RESET SELECTOR <i class="fas fa-undo"></i></a>
        </div>
    </div>
</section>
<script type="text/javascript">
/* Adopted from https://pytorch.org/assets/quick-start-module.js */
var pkg = ["cudf", "cuml", "cugraph", "cusignal", "cuspatial", "cuxfilter", "all"];
var method = ["conda", "runtime", "source", "devel"];
var release = ["legacy", "stable", "nightly"];
var type = ["rapids", "rapidscore"];
var linux = ["ubuntu1604", "ubuntu1804", "ubuntu20.04", "centos7", "centos8", "rhel7"];
var python = ["py37", "py38"];
var cuda = ["cuda110", "cuda112"];
var pkg_opts = $(".pkg > .option");
var method_opts = $(".method > .option");
var release_opts = $(".release > .option");
var type_opts = $(".type > .option");
var linux_opts = $(".linux > .option");
var python_opts = $(".python > .option");
var cuda_opts = $(".cuda > .option");
var details = {
    conda: "conda-install",
    docker: "docker-container",
    source: "build-from-source"
}
// Set initial choices
var selections = {
    pkg: "all",
    method: "conda",
    release: "stable",
    type: "rapids",
    linux: "ubuntu1804",
    python: "py37",
    cuda: "cuda110"
};
// Save default choices
var default_selections = Object.assign({}, selections);
// Setup listeners
pkg_opts.on("click", function() {
    processClick(pkg_opts, this, "pkg");
});
method_opts.on("click", function() {
    processClick(method_opts, this, "method");
});
release_opts.on("click", function() {
    processClick(release_opts, this, "release");
});
type_opts.on("click", function() {
    processClick(type_opts, this, "type");
});
linux_opts.on("click", function() {
    processClick(linux_opts, this, "linux");
});
python_opts.on("click", function() {
    processClick(python_opts, this, "python");
});
cuda_opts.on("click", function() {
    processClick(cuda_opts, this, "cuda");
});

// Initialize on start
$(function() {
    processClick();
});

// Reset all options
function resetAll() {
    $(method_opts).removeClass("disabled");
    $(pkg_opts).removeClass("disabled");
    $(release_opts).removeClass("disabled");
    $(type_opts).removeClass("disabled");
    $(linux_opts).removeClass("disabled");
    $(python_opts).removeClass("disabled");
    $(cuda_opts).removeClass("disabled");
    $(method_opts).removeClass("active");
    $(pkg_opts).removeClass("active");
    $(release_opts).removeClass("active");
    $(type_opts).removeClass("active");
    $(linux_opts).removeClass("active");
    $(python_opts).removeClass("active");
    $(cuda_opts).removeClass("active");
}

// Reset to default choices
function resetSelector() {
    selections = Object.assign({}, default_selections);
    processClick();
}

// Process clicks on options
function processClick(options, click, category) {
    // Reset the board
    resetAll();

    // Hide linux/rhel/docker notes
    $("#rhel7-conda-note").addClass("hidden");
    $("#rhel7-source-note").addClass("hidden");
    $("#linux-conda-note").addClass("hidden");
    $("#linux-source-note").addClass("hidden");
    $("#base-docker-note").addClass("hidden");

    // Record selection
    if (click && category) {
        selections[category] = click.id;
    }

    // Handle exclusions
    if (selections["method"] == "conda") {
        // Handle conda requests
        if (selections["linux"] == "rhel7") {
            // Display RHEL note
            $("#rhel7-conda-note").removeClass("hidden");
        } else {
            // Display linux note
            $("#linux-conda-note").removeClass("hidden");
        }
    } else if (selections["method"] == "runtime") {
        // Handle docker runtime requests
        if (selections["linux"] == "rhel7") {
            selections["linux"] = "centos7";
        }
        // Display base note
        $("#base-docker-note").removeClass("hidden");
        $("#rhel7").addClass("disabled");
        $(pkg_opts).addClass("disabled");
        selections["pkg"] = "all";
        $("#all").removeClass("disabled");
    } else if (selections["method"] == "source") {
        // Handle source requests
        $("#all").addClass("disabled");
        if (selections["pkg"] == "all") {
            selections["pkg"] = "cudf";
        }
        if (selections["linux"] == "rhel7") {
            // Display RHEL note
            $("#rhel7-source-note").removeClass("hidden");
        } else {
            // Display linux note
            $("#linux-source-note").removeClass("hidden");
        }
        $(python_opts).removeClass("active");
        $(cuda_opts).removeClass("active");
        $(type_opts).removeClass("active");
        $(python_opts).addClass("disabled");
        $(cuda_opts).addClass("disabled");
        $(type_opts).addClass("disabled");
    } else if (selections["method"] == "devel") {
        // Handle docker devel requests
        if (selections["linux"] == "rhel7") {
            selections["linux"] = "centos7";
        }
        selections["pkg"] = "all";
        $("#rhel7").addClass("disabled");
        $(pkg_opts).addClass("disabled");
        $("#all").removeClass("disabled");
        $(method_opts).removeClass("disabled");
        $(release_opts).removeClass("disabled");
    } 
    if (selections["release"] == "nightly") {
        // Handle ubuntu16.04 deprecation
        $("#ubuntu1604").addClass("disabled");
        if (selections["linux"] == "ubuntu1604") {
            selections["linux"] = "ubuntu1804";
        }
    }

    // Mark active options
    $("#" + selections["method"]).addClass("active");
    $("#" + selections["pkg"]).addClass("active");
    $("#" + selections["linux"]).addClass("active");
    $("#" + selections["python"]).addClass("active");
    $("#" + selections["cuda"]).addClass("active");
    $("#" + selections["release"]).addClass("active");
    $("#" + selections["type"]).addClass("active");

    showCommand();
}

function getSelections() {
    if (selections["method"] == "source") {
        return "" + selections["release"] + "-" + selections["pkg"] + "-" + selections["method"];
    } else if (selections["method"] == "conda") {
        return "" + selections["release"] + "-" + selections["type"] + "-" + selections["pkg"] + "-" + selections["method"] + "-" + selections["python"] + "-" + selections["cuda"];
    } else {
        return "" + selections["release"] + "-" + selections["type"] + "-" + selections["pkg"] + "-" + selections["method"] + "-" + selections["linux"] + "-" + selections["python"] + "-" + selections["cuda"];
    }
}

function showCommand() {
    var key = getSelections();
    var command = $("." + key).html();
    var anchor = details[selections["method"]];
    var txt = ("" + selections["method"] + " details").toUpperCase();
    $("#command").html(command);
    $("#command > div > pre > code ").attr("id", "command-code")
}

function CopyToClipboard(containerid) {
    if (document.selection) { //IE
        var range = document.body.createTextRange();
        range.moveToElementText(document.getElementById(containerid));
        range.select();
        document.execCommand("copy");
    } else if (window.getSelection) { //others
        var range = document.createRange();
        range.selectNode(document.getElementById(containerid));
        window.getSelection().removeAllRanges();
        window.getSelection().addRange(range);
        document.execCommand("copy");
    }
}
</script>
<!--
    FYI commands moved to "selector-commands-*.html" one for each release type:
      - selector-commands-stable.html
      - selector-commands-nightly.html
-->
